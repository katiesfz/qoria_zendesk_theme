<footer class="footer">
  <div class="container" style="padding-bottom: 64px;">
    <div class="row">
      <div class="col">
        <hr style="margin: 32px 0;">
      </div>
    </div>
    <div class="row">

      <div class="col">
        {{#link 'help_center'}}
          <img src="{{settings.logo_inverse}}" style="width: 180px;">
        {{/link}}
      </div>

      <div class="col">
        <ul>
          {{#link 'new_request'}}
            <li>
              <h6>
                Submit a request
              </h6>
            </li>
          {{/link}}
          <li>
            <h6>
              <a href="https://fzo.statuspage.io/">
              Status page
              </a>
            </h6>
          </li>
          <li>
            <h6>
              <a href="{{settings.website}}">
                Back to {{settings.website_string}}
              </a>
            </h6>
          </li>
        </ul>
      </div>

      <div class="col">
        <ul>
          <li>
            <h6>
              <a href="{{settings.contact_link}}">
                Contact us
              </a>
            </h6>
          </li>
          <li>
            <h6>
              {{#if settings.show_facebook_link}}
                <a href="{{settings.facebook_link}}">
                  <i class="fa fa-brands fab fa-lg fa-facebook-square me-3" style="margin-right: 0.5em;"></i>
                </a>
              {{/if}}
              {{#if settings.show_linkedin_link}}
                <a href="{{settings.linkedin_link}}">
                  <i class="fa fa-brands fab fa-lg fa-linkedin me-3" style="margin-right: 0.5em;"></i>
                </a>
              {{/if}}
              {{#if settings.show_youtube_link}}
                <a href="{{settings.youtube_link}}">
                  <i class="fa fa-brands fab fa-lg fa-youtube-square me-3" style="margin-right: 0.5em;"></i>
                </a>
              {{/if}}
              {{#if settings.show_xitter_link}}
                <a href="{{settings.xitter_link}}">
                  <i class="fa fa-brands fab fa-lg fa-x-twitter"></i>
                </a>
              {{/if}}
            </h6>
          </li>
        </ul>
      </div>
    </div>
    {{#if settings.copyright_message}}
    <div class="row">
      <div class="col">
        <p class="copyright">
        &copy; <span id="currentYear"></span> {{settings.copyright_message}}
        </p>
      </div>
    </div>
    {{/if}}
  </div>
</footer>

<script>
  document.addEventListener('DOMContentLoaded', function() {
      // add current year to copyright message
      const span = document.getElementById('currentYear');
      const year = new Date().getFullYear();
      span.textContent = year;

      // hide chat widget if it's shown by default
      zE('messenger', 'hide');

  });
</script>



{{#if settings.show_chat}}

  {{#if settings.chat_snippet}}
    <script>

      function unescapeHTML(escapedStr) {
        const textarea = document.createElement('textarea');
        textarea.innerHTML = escapedStr;
        return textarea.value;
      }
      const chatSnippetEsc = "{{~settings.chat_snippet~}}";
      const chatSnippet = unescapeHTML(chatSnippetEsc);
      var chatSrc = "";

      // check if snippet is zendesk chat widget
      if (chatSnippet.includes("ze-snippet")) {
        // zendesk snippet
        const zendeskChatRegex = /(?<=src=").*(?=")/g;
        chatSrc = chatSnippet.match(zendeskChatRegex);
      }

      const chatScript = document.createElement('script');
      chatScript.id = "ze-snippet";
      chatScript.src = chatSrc;
      chatScript.type = 'text/javascript';

      chatScript.addEventListener("load",function(){console.log("chat has loaded");zE("messenger", "show");}, false);

    //  chatScript.onload = function(){
    //    console.log("chat has loaded");
    //    zE('messenger', 'show');
    //  };

      {{#if settings.chat_gated}}
        {{#if signed_in}}
          // chat is gated and user is signed in
          document.body.appendChild(chatScript);
        {{else}}
          // chat is gated and user is not signed in
        {{/if}}
      {{else}}
        // chat is not gated
        document.body.appendChild(chatScript);
      {{/if}}
        
    </script>
    
  {{/if}}

{{/if}}
